spring:
  application:
    name: vidtag
  ai:
    anthropic:
      api-key: ${VIDTAG_CLAUDE_API_KEY:}
      chat:
        options:
          model: claude-haiku-4-5
          #model: claude-sonnet-4-5
          #model: claude-opus-4-5

logging:
  level:
    org.bartram: DEBUG

# External API Configuration
youtube:
  api:
    key: ${YOUTUBE_API_KEY:}

raindrop:
  api:
    token: ${RAINDROP_API_TOKEN:}

  # Redis Cache Configuration
  cache:
    type: redis
    redis:
      time-to-live: 15m  # 15 minutes
      cache-null-values: false

# VidTag Application Configuration
vidtag:
  # Enable debug mode globally (overridden by ?debug=true param)
  debug-mode: ${DEBUG_MODE:false}

  # Error response configuration
  error:
    include-stack-trace: ${INCLUDE_STACK_TRACE:false}
    include-binding-errors: true
    max-stack-trace-length: 2000

  # Scheduler Configuration
  scheduler:
    enabled: false  # Enable/disable scheduled playlist processing
    fixed-delay-hours: 1  # Delay between job executions in hours
    playlist-ids: ${VIDTAG_YT_PLAYLIST_IDS:}  # Comma-separated YouTube playlist IDs (e.g., PLxxx...,PLyyy... from https://www.youtube.com/playlist?list=PLxxx...)

  # Tag Filtering Configuration
  tagging:
    # Comma-separated list of tags to block from AI suggestions (empty = disabled)
    blocked-tags: ${VIDTAG_TAGGING_BLOCKED_TAGS:youtube,golf-tips,golf-instruction,golf-swing,swing-analysis,online-coaching,pga-instruction

  # Raindrop.io Configuration
  raindrop:
    # Fallback collection when AI confidence is low
    fallback-collection: ${VIDTAG_RAINDROP_FALLBACK_COLLECTION:videos}
    # Cache TTL for playlist â†’ collection mappings
    collection-cache-ttl: ${VIDTAG_RAINDROP_COLLECTION_CACHE_TTL:24h}
    # Cache TTL for user's collection list
    collections-list-cache-ttl: ${VIDTAG_RAINDROP_COLLECTIONS_LIST_CACHE_TTL:1h}

# Resilience4J Circuit Breaker Configuration
resilience4j:
  circuitbreaker:
    instances:
      youtube:
        failure-rate-threshold: 50
        wait-duration-in-open-state: 30s
        permitted-number-of-calls-in-half-open-state: 3
        sliding-window-type: COUNT_BASED
        sliding-window-size: 10
        minimum-number-of-calls: 5
      raindrop:
        failure-rate-threshold: 50
        wait-duration-in-open-state: 30s
        permitted-number-of-calls-in-half-open-state: 3
        sliding-window-type: COUNT_BASED
        sliding-window-size: 10
        minimum-number-of-calls: 5
      claude:
        failure-rate-threshold: 50
        wait-duration-in-open-state: 30s
        permitted-number-of-calls-in-half-open-state: 3
        sliding-window-type: COUNT_BASED
        sliding-window-size: 10
        minimum-number-of-calls: 5

  retry:
    instances:
      youtube:
        max-attempts: 3
        wait-duration: 1s
        exponential-backoff-multiplier: 2
      raindrop:
        max-attempts: 3
        wait-duration: 1s
        exponential-backoff-multiplier: 2
      claude:
        max-attempts: 3
        wait-duration: 1s
        exponential-backoff-multiplier: 2
